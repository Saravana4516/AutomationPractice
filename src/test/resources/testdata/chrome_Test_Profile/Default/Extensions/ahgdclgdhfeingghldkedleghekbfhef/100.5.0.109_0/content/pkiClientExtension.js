"undefined"==typeof pkiClientExtension&&(pkiClientExtension={});(function(){var c={};pkiClientExtension.common=c;c.DOM_ID="__symantecPKIClientMessenger";c.EVENT_REQUEST="SymantecPKIClientMessage";c.EVENT_RESPONSE="SymantecPKIClientMessageResponse"})();
(function(){var c=function(a){Object.keys(a).forEach(function(b){var c=a[b];if(null!==c&&!(Object(c)instanceof String))throw new Exception("Property "+b+" of datasetProperties is not a string/null");if(/-[a-z]/.test(b))throw new Exception("Property "+b+" contains an illegal sequence of dash followed by lowercase a-z");})},d=function(a,b){this.forwardMessage=a;this.datasetProperties=b||{};c(this.datasetProperties);this.accounting={}};pkiClientExtension.commonBridge={};pkiClientExtension.commonBridge.Bridge=
d;d.prototype={};d.prototype.bind=function(){var a=document.createElement("OBJECT");a.style.display="none";a.setAttribute("id",pkiClientExtension.common.DOM_ID);var b=this.datasetProperties;Object.keys(b).forEach(function(c){a.dataset[c]=b[c]});document.body.appendChild(a);this.listener=a;var c=this;a.addEventListener(pkiClientExtension.common.EVENT_REQUEST,function(a){c.handleWebEvent(a)},!1,!0)};d.prototype.handleWebEvent=function(a){console.debug("Got EVENT_REQUEST:",a);a=a.detail;var b=a.id;b?
(this.accounting[b]=!0,this.forwardMessage(a)):console.error("Message had no ID!")};d.prototype.handleResponse=function(a){var b=a.id;b?(console.debug("Got response for id="+b+":",a),this.accounting[b]?(delete this.accounting[b],"function"==typeof cloneInto&&this.listener.ownerDocument&&(a=cloneInto(a,this.listener.ownerDocument)),a=new CustomEvent(pkiClientExtension.common.EVENT_RESPONSE,{detail:a}),this.listener.dispatchEvent(a),console.debug("Sent EVENT_RESPONSE",a)):console.error("Unmatched response, dropping")):
console.error("Message had no ID!")};d.prototype.detach=function(){for(var a;;){a=document.getElementById(pkiClientExtension.common.DOM_ID);if(!a)break;a.remove()}}})();
